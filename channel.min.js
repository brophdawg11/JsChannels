!function(n,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t():n.Channel=t()}(this,function(){"use strict";function n(n){function t(){!p&&u.length>0&&(o=-1,s=u.shift(),e.apply(this))}function e(){return++o>=l.length||null===s?(o=-1,s=null,void t.apply(this)):(l[o].apply(this,s),void(p||e.apply(this)))}var r,i=this,u=[],l=[],o=-1,s=null,p=!1,a={};n="object"==typeof n?n:{};for(r in a)("undefined"==typeof n[r]||n[null===r])&&(n[r]=a[r]);this.read=function(n){return l.push(n),t.apply(this),i},this.unread=function(n){for(var t=-1,e=l.length;++t<e;)if(l[t]===n){l.splice(t,1);break}return i},this.block=function(){return p?!1:(p=!0,!0)},this.unblock=function(){return p?(p=!1,e.apply(this),!0):!1},this.write=function(){return 0===l.length||u.length>0||p||o>=0?u.push(arguments):(s=arguments,e.apply(this)),i}}return n.alts=function(n){for(var t,e=Array.prototype.splice.call(arguments,1),r=-1,i=e.length;++r<i;)t=e[r],t.read(n.bind(this,t))},n.select=function(n){function t(n,t){return function(n){for(var e=-1,i=r.length;++e<i;)r[e].unread(l[e]);return t.apply(n,arguments)}.bind(null,n)}for(var e,r=Array.prototype.splice.call(arguments,1),i=-1,u=r.length,l=[];++i<u;)e=r[i],l.push(t(e,n)),e.read(l[i])},n});